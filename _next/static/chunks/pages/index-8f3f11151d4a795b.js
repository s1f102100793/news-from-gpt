(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9208:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(1743)}])},1743:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return G}});var s=n(5893),r=n(7294),a=n(9239),l=n(7080),o=n(6154);let i=(e=>{let{baseURL:t,fetch:n}=e,s=(void 0===t?"":t).replace(/\/$/,""),r="/gpt",a="/health",o="/news",i="/session",c="/tasks",u="/trends",d="POST",h="DELETE",m="PATCH";return{gpt:{get:e=>n(s,r,"GET",e).text(),$get:e=>n(s,r,"GET",e).text().then(e=>e.body),post:e=>n(s,r,d,e).json(),$post:e=>n(s,r,d,e).json().then(e=>e.body),$path:()=>"".concat(s).concat(r)},health:{get:e=>n(s,a,"GET",e).text(),$get:e=>n(s,a,"GET",e).text().then(e=>e.body),$path:()=>"".concat(s).concat(a)},me:{get:e=>n(s,"/me","GET",e).json(),$get:e=>n(s,"/me","GET",e).json().then(e=>e.body),$path:()=>"".concat(s).concat("/me")},news:{get:e=>n(s,o,"GET",e).json(),$get:e=>n(s,o,"GET",e).json().then(e=>e.body),post:e=>n(s,o,d,e).send(),$post:e=>n(s,o,d,e).send().then(e=>e.body),$path:()=>"".concat(s).concat(o)},session:{post:e=>n(s,i,d,e).json(),$post:e=>n(s,i,d,e).json().then(e=>e.body),delete:e=>n(s,i,h,e).json(),$delete:e=>n(s,i,h,e).json().then(e=>e.body),$path:()=>"".concat(s).concat(i)},tasks:{_taskId:e=>{let t="".concat(c,"/").concat(e);return{patch:e=>n(s,t,m,e).send(),$patch:e=>n(s,t,m,e).send().then(e=>e.body),delete:e=>n(s,t,h,e).send(),$delete:e=>n(s,t,h,e).send().then(e=>e.body),$path:()=>"".concat(s).concat(t)}},get:e=>n(s,c,"GET",e).json(),$get:e=>n(s,c,"GET",e).json().then(e=>e.body),post:e=>n(s,c,d,e).json(),$post:e=>n(s,c,d,e).json().then(e=>e.body),$path:e=>"".concat(s).concat(c).concat(e&&e.query?"?".concat((0,l._K)(e.query)):"")},trends:{get:e=>n(s,u,"GET",e).json(),$get:e=>n(s,u,"GET",e).json().then(e=>e.body),$path:()=>"".concat(s).concat(u)},get:e=>n(s,"","GET",e).text(),$get:e=>n(s,"","GET",e).text().then(e=>e.body),$path:()=>"".concat(s)}})((0,a.Z)(o.Z.create({withCredentials:!0}))),c=()=>{var e;let[t,n]=(0,r.useState)(null),[s,a]=(0,r.useState)([]),[l,o]=(0,r.useState)(null),[c,u]=(0,r.useState)(!0),d=async()=>{let e=await i.news.$get();return e},h=(e=>{let t=new Map;return e.forEach(e=>{let n=t.get(e.name);"number"==typeof n?t.set(e.name,n+1):t.set(e.name,1)}),t})(s),m=e=>e.replace(/[\u30a1-\u30f6]/g,e=>{let t=e.charCodeAt(0)-96;return String.fromCharCode(t)}),_=(e,t)=>{let n=m(e),s=m(t);return n.localeCompare(s)},p=(e=Array.from(h.entries()),"alphabetical"===l?e.sort((e,t)=>c?_(e[0],t[0]):_(t[0],e[0])):"count"===l?e.sort((e,t)=>c?e[1]-t[1]:t[1]-e[1]):e),[g,b]=(0,r.useState)(""),[x,y]=(0,r.useState)(1),[j,w]=(0,r.useState)("oldest"),C=(0,r.useCallback)(e=>"newest"===j?[...e].sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()):[...e].sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()),[j]);return{selectedName:t,setSelectedName:n,resetSelectedName:()=>{n(null)},newsData:s,setNewsData:a,fetchNews:d,nameCounts:h,toggleSort:e=>{l===e?u(!c):o(e)},sortedNames:p,searchTerm:g,handleSearchChange:e=>{b(e.target.value)},sortOrder:j,sortByDate:C,toggleSortByDate:()=>{w(e=>"newest"===e?"oldest":"newest"),y(1)},setButtonMain:y,buttomMain:x}};var u=e=>{let{sortedNames:t,handleNameClick:n,styles:r}=e;return(0,s.jsx)(s.Fragment,{children:t.map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{onClick:()=>n(t),className:r.nameItem,children:[t," (",a,")"]},t)})})},d=e=>{let{selectedName:t,searchTerm:n,handleSearchChange:r,handleSearch:a,onSubmit:l,styles:o}=e;return null===t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"text",value:n,onChange:r,placeholder:"名前を検索",className:o.searchInput}),(0,s.jsx)("button",{onClick:a,className:o.searchButton,children:"検索"})]}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("button",{onClick:l,className:o.buttonWithSelectedName,children:"この話題の新しいの記事を生成"})})},h=e=>{let{selectedName:t,nameCounts:n,newsData:r,handleNameClick:a,handleArticleClick:l,styles:o}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{onClick:()=>a(t),className:o.nameItem,children:[t," (",n.get(t),")"]}),(0,s.jsx)("ul",{className:o.nameList,children:r.filter(e=>e.name===t).map((e,t)=>(0,s.jsxs)("li",{onClick:()=>l(e),children:[(0,s.jsx)("div",{className:o.title,children:e.title}),(0,s.jsx)("div",{className:o.subtitle,children:e.subtitle})]},t))})]})},m=e=>{let{selectedName:t,toggleSort:n,toggleSortByDate:r,toggleSortByClickCount:a,sortOrder:l,styles:o}=e;return null===t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:o.button,onClick:()=>n("alphabetical"),children:"あいうえお順"}),(0,s.jsx)("button",{className:o.button,onClick:()=>n("count"),children:"記事数順"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{className:o.button,onClick:r,children:"newest"===l?"古い順":"最新順"}),(0,s.jsx)("button",{className:o.button,onClick:a,children:"クリック数順"})]})},_=n(7790),p=n.n(_),g=e=>{let{onArticleClick:t,selectedName:n,setSelectedName:a,onSubmit:l}=e,{newsData:o,setNewsData:i,fetchNews:_,nameCounts:g,toggleSort:b,sortedNames:x,searchTerm:y,handleSearchChange:j,sortOrder:w,sortByDate:C,toggleSortByDate:N,setButtonMain:v,buttomMain:S}=c(),f=async e=>{a(e)},T=async e=>{t(e)},E=e=>[...e].sort((e,t)=>t.clickCount-e.clickCount);return(0,r.useEffect)(()=>{let e=async()=>{let e=await _();i(1===S?C(e):E(e))},t=setInterval(e,100);return()=>clearInterval(t)},[_,i,C,S]),(0,s.jsxs)("div",{className:p().container,children:[(0,s.jsxs)("div",{className:p().buttonAndSearchContainer,children:[(0,s.jsx)("div",{className:p().buttonContainer,children:(0,s.jsx)(m,{selectedName:n,toggleSort:b,toggleSortByDate:N,toggleSortByClickCount:()=>{let e=E(o);i(e),v(0)},sortOrder:w,styles:p()})}),(0,s.jsx)("div",{className:p().searchContainer,children:(0,s.jsx)(d,{selectedName:n,searchTerm:y,handleSearchChange:j,handleSearch:()=>{let e=x.find(e=>{let[t]=e;return t.includes(y)});e&&f(e[0])},onSubmit:l,styles:p()})})]}),null===n?(0,s.jsx)(u,{sortedNames:x,handleNameClick:f,styles:p()}):(0,s.jsx)(h,{selectedName:n,nameCounts:g,newsData:o,handleNameClick:f,handleArticleClick:T,styles:p()})]})},b=n(1442),x=n.n(b),y=e=>{let{value:t,onChange:n,onSubmit:r,onReset:a,isLoading:l}=e;return(0,s.jsxs)("div",{className:x().newsInputContainer,children:[(0,s.jsx)("button",{className:x().buttonStyle,onClick:a,children:"TOPへ"}),(0,s.jsxs)("div",{className:x().rightContainer,children:[l&&(0,s.jsx)("div",{className:x().spinner}),(0,s.jsx)("input",{type:"text",value:t,onChange:n,placeholder:"正確なニュースの話題名を入力",className:x().inputStyle}),(0,s.jsx)("button",{onClick:r,className:x().buttonStyle,children:"作成"})]})]})},j=n(23),w=n.n(j),C=e=>{let{value:t,onChange:n,onSubmit:a,onReset:l,isLoading:o}=e,[i,c]=(0,r.useState)(new Date);(0,r.useEffect)(()=>{let e=setInterval(()=>{c(new Date)},6e4);return()=>clearInterval(e)},[]);let u="".concat(i.toLocaleString("en-US",{month:"long",day:"2-digit",year:"numeric"})," - ").concat(i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}));return(0,s.jsxs)("div",{className:w().headerContainer,children:[(0,s.jsx)("div",{className:w().headerLine}),(0,s.jsxs)("h1",{className:w().headerTitle,children:["GPT",(0,s.jsx)("span",{className:w().yellowText,children:"N"}),"EWS"]}),(0,s.jsx)("div",{className:w().dateTime,children:u}),(0,s.jsx)("div",{className:w().headerLine}),(0,s.jsx)(y,{value:t,onChange:n,onSubmit:a,onReset:l,isLoading:o})]})};let N=()=>{let e=(0,r.useRef)(null),t=(0,r.useRef)(null),[n,a]=(0,r.useState)(""),[l,o]=(0,r.useState)("title"),[i,c]=(0,r.useState)(0);return{titleRef:e,containerRef:t,currentText:n,setCurrentText:a,displayProgress:l,setDisplayProgress:o,currentIndex:i,setCurrentIndex:c,DisplayText:e=>{let{currentProgress:t,targetProgress:n,current:r,defaultText:a}=e;if(t===n)return(0,s.jsx)(s.Fragment,{children:r});switch(n){case"title":return(0,s.jsx)(s.Fragment,{children:a});case"subtitle":return"title"!==t?(0,s.jsx)(s.Fragment,{children:a}):null;case"body":return"title"!==t&&"subtitle"!==t?(0,s.jsx)(s.Fragment,{children:a}):null;default:return null}},VideoContent:e=>{let{video:t,displayProgress:n}=e;return"complete"===n?(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:t}}):null}}};var v=n(6462),S=n.n(v),f=e=>{let{title:t,subtitle:n,body:a,video:l}=e,{titleRef:o,containerRef:i,currentText:c,setCurrentText:u,displayProgress:d,setDisplayProgress:h,currentIndex:m,setCurrentIndex:_,DisplayText:p,VideoContent:g}=N();return(0,r.useEffect)(()=>{let e=()=>{switch(d){case"title":return t;case"subtitle":return n;case"body":return a;case"video":return h("complete"),"";default:return""}},s=e=>{switch(e){case"title":return"subtitle";case"subtitle":return"body";case"body":return"video";default:return"complete"}},r=setInterval(()=>{let t=e();if("video"===d){clearInterval(r);return}m<t.length?(u(e=>e+t[m]),_(e=>e+1)):(clearInterval(r),h(s(d)),u(""),_(0))},50);return()=>clearInterval(r)},[t,n,a,d,m,_,u,h]),(0,r.useEffect)(()=>{let e=(e,t,n,s)=>Math.min(e*(t/n),s),t=()=>{let t=o.current,n=i.current;if(!t||!n)return;let s=.8*n.offsetWidth,r=parseFloat(window.getComputedStyle(t).fontSize);if(t.offsetWidth!==s){let a=e(r,s,t.offsetWidth,36);t.style.fontSize="".concat(a,"px"),n.style.setProperty("--dynamic-title-font-size","".concat(a,"px"))}};return"title"===d&&t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[t,c,d,i,o]),(0,s.jsxs)("div",{className:S().newsContainer,ref:i,children:[(0,s.jsx)("h1",{className:S().newsTitle,ref:o,children:(0,s.jsx)(p,{currentProgress:d,targetProgress:"title",current:c,defaultText:t})}),(0,s.jsx)("h2",{className:S().newsSubtitle,children:(0,s.jsx)(p,{currentProgress:d,targetProgress:"subtitle",current:c,defaultText:n})}),(0,s.jsx)("p",{className:S().newsBody,children:(0,s.jsx)(p,{currentProgress:d,targetProgress:"body",current:c,defaultText:a})}),(0,s.jsx)("div",{className:S().videoContainer,children:(0,s.jsx)(g,{video:l,displayProgress:d})})]})},T=n(8583),E=n(5103);let k=(0,E.cn)(null),$=()=>{let[e]=(0,T.KO)(k),[t,n]=(0,r.useState)(""),[s,a]=(0,r.useState)(null),[l,o]=(0,r.useState)(null),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(null),[m,_]=(0,r.useState)(!1),p=async e=>{o(e.title),u(e.subtitle),a(e.body),h(e.video);let t=e.clickCount+1;await i.news.$post({body:{id:e.id,name:e.name,title:e.title,subtitle:e.subtitle,body:e.body,video:e.video,clickCount:t}})},g=async()=>{console.log("押した");try{let e=await i.gpt.$post({body:{name:t}});o(null),u(null),a(null),h(null),o(e.title),u(e.subtitle),a(e.body),h(e.video),n("")}catch(e){e.response?(console.error("Error data:",e.response.data),console.error("Error status:",e.response.status)):null!==e.request&&void 0!==e.request?console.error("No response from server:",e.request):console.error("Error:",e.message)}},b=async()=>{_(!0),await g(),_(!1)};return{user:e,inputValue:t,setInputValue:n,responsebody:s,setResponsebody:a,responsetitle:l,setResponsetitle:o,responsesubtitle:c,setResponsesubtitle:u,responsevideo:d,setResponsevideo:h,handleInputChange:e=>{n(e.target.value)},handleArticleClick:p,handleOnSubmit:b,shouldRenderNewsComponent:(e,t,n,s)=>null!==e&&null!==t&&null!==n&&null!==s,isLoading:m,setIsLoading:_,postBackend:g}};var I=n(2729),B=n.n(I),G=()=>{let{inputValue:e,setInputValue:t,responsebody:n,setResponsebody:r,responsetitle:a,setResponsetitle:l,responsesubtitle:o,setResponsesubtitle:u,responsevideo:d,handleInputChange:h,handleArticleClick:m,handleOnSubmit:_,setResponsevideo:p,shouldRenderNewsComponent:b,isLoading:x,setIsLoading:y}=$(),{selectedName:j,setSelectedName:w,resetSelectedName:N}=c(),v=async()=>{l(null),u(null),r(null),N()},S=e=>{if(null===e||""===e)throw console.error("Name is not defined or empty"),Error("Name is not valid");return e},T=async()=>{let e=S(j);t(e),console.log(j),console.log("押した");try{let n=await i.gpt.$post({body:{name:e}});l(null),u(null),r(null),p(null),l(n.title),u(n.subtitle),r(n.body),p(n.video),t("")}catch(e){e.response?(console.error("Error data:",e.response.data),console.error("Error status:",e.response.status)):null!==e.request&&void 0!==e.request?console.error("No response from server:",e.request):console.error("Error:",e.message)}},E=async()=>{y(!0),await T(),y(!1)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:B().container,children:[(0,s.jsx)(C,{value:e,onChange:h,onSubmit:_,onReset:v,isLoading:x}),b(a,o,n,d)?(0,s.jsx)(f,{title:a,subtitle:o,body:n,video:d}):(0,s.jsx)(g,{onArticleClick:m,selectedName:j,setSelectedName:w,onSubmit:E})]})})}},7790:function(e){e.exports={container:"namelist_container__vh1We",buttonAndSearchContainer:"namelist_buttonAndSearchContainer__bhYAl",buttonContainer:"namelist_buttonContainer__CosS5",button:"namelist_button__OE4Vm",searchContainer:"namelist_searchContainer__Fjfvq",searchInput:"namelist_searchInput__z_nrm",searchButton:"namelist_searchButton__PO5vq",nameItem:"namelist_nameItem__4kPrk",selected:"namelist_selected__R8C9v",nameList:"namelist_nameList__51mER",title:"namelist_title__biNxC",subtitle:"namelist_subtitle__aZgx3",spinner:"namelist_spinner__aXivN",spin:"namelist_spin__fkpgo",buttonWithSelectedName:"namelist_buttonWithSelectedName__qiWRQ"}},23:function(e){e.exports={headerContainer:"Header_headerContainer__GBWLB",dateTime:"Header_dateTime__ulunl",headerLine:"Header_headerLine__tYu1Q",headerTitle:"Header_headerTitle__XkMB_",yellowText:"Header_yellowText__EaQ6H"}},6462:function(e){e.exports={newsContainer:"news_newsContainer__2Oae3",newsTitle:"news_newsTitle__B4y6a",newsSubtitle:"news_newsSubtitle__0e_uB",newsBody:"news_newsBody__hBcMK",videoContainer:"news_videoContainer__c7y5i"}},1442:function(e){e.exports={newsInputContainer:"NewsInput_newsInputContainer__OOhXd",inputStyle:"NewsInput_inputStyle__e9rOB",buttonStyle:"NewsInput_buttonStyle__9uBq3",rightContainer:"NewsInput_rightContainer__JtMGj",spinner:"NewsInput_spinner__Z2g18",spin:"NewsInput_spin__AqQtS"}},2729:function(e){e.exports={container:"index_container___q52_",responseContainer:"index_responseContainer__sNuwe"}}},function(e){e.O(0,[911,774,888,179],function(){return e(e.s=9208)}),_N_E=e.O()}]);